<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>IFC Viewer</title>
<style>
  html, body { margin: 0; padding: 0; height: 100%; overflow: hidden; }
  #viewer-container { width: 100%; height: 100%; }
</style>
</head>
<body>
<div id="viewer-container"></div>

<script type="module">
  import { IfcViewerAPI } from 'https://cdn.jsdelivr.net/npm/web-ifc-viewer@latest/dist/IFCviewerAPI.module.js';

  // Create the viewer
  const container = document.getElementById('viewer-container');
  const viewer = new IfcViewerAPI({ container, backgroundColor: 0xffffff });
  viewer.grid.setGrid();
  viewer.axes.setAxes();

  // Load IFC file
  const ifcFile = 'BIM_file.ifc'; // Must exist in same folder
  const input = document.createElement('input');
  input.type = 'file';
  input.accept = '.ifc';
  input.style.display = 'none';
  document.body.appendChild(input);

  input.addEventListener('change', async (event) => {
    const file = event.target.files[0];
    if (!file) return;
    const url = URL.createObjectURL(file);
    await viewer.IFC.loadIfcUrl(url);
  });

  // Auto-load local BIM_file.ifc if exists
  fetch(ifcFile, { method: 'HEAD' })
    .then(res => {
      if(res.ok){
        input.files = createFileList(ifcFile); // trick to auto-load local file
        viewer.IFC.loadIfcUrl(ifcFile);
      }
    })
    .catch(() => console.warn('BIM_file.ifc not found.'));

  // Helper for auto-loading
  function createFileList(fileName) {
    const dataTransfer = new DataTransfer();
    const file = new File([''], fileName);
    dataTransfer.items.add(file);
    return dataTransfer.files;
  }

</script>
</body>
</html>
